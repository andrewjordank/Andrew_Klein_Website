{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to my website!","text":"<p>This website will be updated to fit the needs of Andrew Klein's Graduate career</p> <p>Please click on the headers above to navigate the site</p>"},{"location":"filler/","title":"Data Management Plan","text":"<p>If you're seeing this, that means that Andrew hasn't created what is actually supposed to be here. I'm sure he's working on it and it will be amazing, just be patient...</p>"},{"location":"formulating_LD_plots-Andrew_Klein/","title":"Making a Pairwise LD Plot Using LDBlock Show","text":"<p>Andrew Klein andrewjklein@arizona.edu</p> <p>Our goal is to create a pairwise LD plot of the SNPs used to determine ABO blood type alleles. These SNPs were identified during a systematic review and include both functional SNPs and tag SNPs. </p> <p>The O vs non-O SNPs include: * rs8176719 * rs8176704 * rs687289 * rs657152 * rs612169 * rs8176645 * rs505922 * rs529565</p> <p>The A vs B SNPs include:  * rs8176749 * rs8176747 * rs8176746 * rs8176743 * rs8176741 * rs7853989 * rs8176722 * rs8176720 * rs8176672</p> <p>The documented code will be run on the Karnes Server and we are making the LD plots using the pangenomic 1000g file that can be found here. This file will also contain the notes/thoughts that Andrew was thinking about while making these plots. You will see how he learned how to use PLINK, command line, and LDBlockShow as this file goes on</p>"},{"location":"formulating_LD_plots-Andrew_Klein/#files-being-used","title":"Files Being Used","text":"<p>All of these files can be found on the Karnes Server under /Data/home/ajklein or /Data/home/ajklein/O_Files or /Data/home/ajklein/B_Files Original Pangenomic 1000Genome file is called 1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz The final VCF files that are being used are: o_snps_chr9_1kgp_high_coverage_recoded.vcf.gz O_AMR.vcf B_AMR.vcf O_AFR.vcf B_AFR.vcf O_EUR.vcf O_EUR.vcf O_EAS.vcf O_EAS.vcf O_SAS.vcf O_SAS.vcf</p> <p>CSV file that contains all the data from the 1000 genomes individuals 1000G_2504_high_coverage.sequence.index.csv </p> <p>Later in this document, I will explain how these files are made</p>"},{"location":"formulating_LD_plots-Andrew_Klein/#programs-being-used","title":"Programs Being Used","text":"<p>LDBlockShow(https://github.com/BGI-shenzhen/LDBlockShow) is a fast and effective tool to generate linkage disequilibrium (LD) heatmap from VCF files. Here is the LDBlockShow GitHub and the LDBlockShow article. LDBLockShow Manual</p> <p>To call upon this program in the Karnes server use this command: /home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow Now here are some other commands I will be using: * <code>-InVCF</code>: the VCF input * <code>-OutPut</code>: the output file of LD blocks * <code>-Region</code>: the region to show the LD info in * <code>-OutPdf</code>: specifying to output as a PDF * <code>ShowNum</code>: shows the R2 values in each cell * <code>-SeleVar 2</code>: <code>1</code> specifies D prime calculations and <code>2</code> specifies r^2 calculation * <code>-SpeSNPName</code>: used to indicate the names for interested SNPs, these names will be shown in the heatmap. * <code>-MAF</code>: Minor allele frequency filter * <code>-InGFF</code>: the GFF3 input for genomic region annotation</p> <p>ShowLDSVG(https://github.com/BGI-shenzhen/LDBlockShow) This is a program included with LDBlockShow. This program is used to change the aesthetics of the plots that LDBlockShow generates. As of 4/6/2023 Andrew has attemtped to use this program but hasn't figured out everything yet. When he begins to tweak the plots this section may be updated.  To call upon this program in the Karnes server use this command: /home/shared/tools/LDBlockShow-1.40/bin/ShowLDSVG * <code>-InPreFix</code>: The output of LD Block Show (it will grab the correct file type you just need to put in the correct directory) * <code>-OutPut</code>: Used to name the output file and choose where it goes * <code>-OutPdf</code>: specifying to output as a PDF * <code>ShowNum</code>: shows the R2 values in each cell</p> <p>PLINK 1.90 beta (https://www.cog-genomics.org/plink/) Plink is a program that allows users to view, edit, and organize multiple types of files. Developed by Christopher Chang with support from the NIH-NIDDK's Laboratory of Biological Modeling, the Purcell Lab, and others. </p> <p>To call upon this program in the Karnes server use this command: plink1.9 Here are some arguments I will be using:&lt;br\" * <code>--vcf</code>: Inputs the VCF file * <code>--extract</code>: Extracts SNPs based on a txt file that tells PLINK the positions of the SNPs * <code>--recode vcf</code>: changes the output to a vcf file * <code>--out</code>: tells the program where to put the output files * <code>--keep</code>: Accepts a txt file that contains the SAMPLE_ID's if individuals and removes everyone else * <code>--make-bed</code>: I don't know why I need this argument but the program tells you to add it in and it didn't work without it * <code>--double-id</code>: Allows PLINK to ignore any _ in the txt file (Shout out to Christopher Chang for this tip)</p> <p>3/14/2023 Andrew's First Attempt</p> <p>This was the first time Andrew attempted to use LDBlock Show. This is the code he used:</p> <p> Takes a vcf as input, look at a certain region, produces a PNG LD Plot </p> <pre> /home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz\n-OutPut /Data/home/ajklein/LDBlock -Region chr9:133247534-133278152 -OutPng -ShowNum -SeleVar 2 </pre> <p>He didn't know how to output the graph as a PDF yet but this first attempt showed every SNP in the region that he provied in the code. While this was not even close to what he wanted to do he was able to use the program.\\ He did some more research and added some more arguments to his code:</p> <p> Take a vcf and a txt files as input, looks at a certain region, label the snps from the txt document, outputs a LD Plot as a PDF </p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz \n-OutPut /Data/home/ajklein/LDBlock_FULL -Region chr9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/O_Snps_Positions.txt -InGFF /Data/home/ajklein/ABOGene.GFF3</pre> <p>Now he was able to output the graphs as a PDF, label the SNPs he was interested in and tried to use a GFF3 file to show exons and label the gene name. But the -InGFF argument was not working for him at this time.</p> <p>3/15/2023 Andrew Tries Again</p> <p>At this point, Andrew was trying to think of a way to only calculate the SNPs he was interested in. He had ideas about how to do this but he went straight to the source by asking the creator of the program on GitHub. The creator seemed to be active with ~3 day response time. While waiting for a response he continued to learn command line. He learned how to use the \"grep\" and \"zcat\" command to find what SNPs are in a VCF file. He was then introduced to PLINK. He will use PLINK to extract the B and O SNPs that he cares about. </p> <p>First, he used zcat and the grep command to look through the vcf file to figure out how the SNPs he cared about are named. He used genome browser to obtain the position of each SNP and used this position to look for each SNP in the VCF file.</p> <pre>zcat 1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz | grep \"133274084\"</pre> <p>He repeated this command for each SNP and this revealed that his SNPs were documented as \"9:133266790:C:A\". He had to copy these locations into a txt file so he can use PLINK to extract these specific SNPs Now that he had all the positions of the SNPs he had to format the txt file in a specific way. One line of this txt file looked like this:</p> <p>chr9  133256205   133256205   9:133256205:G:C</p> <p>This will tell PLINK what SNPs to extract. He was then able to run this code:</p> <p> Creates a new VCF file that only contains the O SNPs     </p> <pre>plink1.9 --vcf /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz \n--extract O_Snps_Positions.txt --recode vcf --out O_Snps_chr9_1kgp_high_coverage</pre> <p>3/20/2023 The First Roadblock</p> <p>Now that Andrew had the filtered VCF file he tried running LDBlock and at first it looked like it created an LD plot of just the O snps but after a careful look the SNPs were not labeled and there was 7 SNPs not 9. He asked the creator of the program on GitHub why the labels were not showing up. It turns out when the filtered VCF was created chromosome 9 was no longer labeled as chr9, it was now labeled 9. Using nano to adjust the txt file for LDBlock show the labels began to show up. The next issue was getting all of the SNPs to show. The creator introduced Andrew to the -MAF command.</p> <p>     Take a vcf and a txt files as input, looks at a certain region, labels the snps from the txt document, reduces the MAF to 0.0001, outputs a LD Plot as a PDF     </p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/O_Snps_chr9_1kgp_high_coverage.vcf.gz \n-OutPut /Data/home/ajklein/LDBlock_V3 -Region 9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/O_Snps_Positions.txt \n-InGFF /Data/home/ajklein/ABOGene.GFF3</pre> <p>After adding this command Andrew was able to get one of the missing SNPs to show.</p> <p>After looking at the log from LDBlock show Andrew realized the reason the last SNP wasn't showing up. This last SNP was an indel, indels notoriously have issues in these types of programs. He explained the issue to Kiana who was able to brute force recode this indel. (She created a markdown file of how she did this.) Once Kiana was able to do this, Andrew could continue his journey.</p> <p>3/23/2023 The B SNPs</p> <p>In the meantime, he began to do the same thing for the B SNPs.</p> <pre>plink1.9 --vcf /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz --extract B_Snps_Positions_Plink.txt --recode vcf --out B_Snps_chr9_1kgp_high_coverage</pre> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz \n-OutPut /Data/home/ajklein/B_LDBlock_1 -Region chr9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/B_Snps_Positions.txt -InGFF /Data/home/ajklein/ABOGene.GFF3</pre> <p>He did the same thing for B as he did for O. Luckily none of the B SNPs were indels so he did not have any issues with this set of SNPs.</p> <p>4/3/23 Return to the O SNPs</p> <p>While waiting for Kiana to figure out the indel Andrew took a week to work on school and try scientific writing for the first time. As referenced before Kiana was able to fix the indel issue. After Andrew received the new recoded vcf file we was able to fix the graph.</p> <p>     Take a vcf and a txt files as input, looks at a certain region, labels the snps from the txt document, reduces MAF to 0.001, looks at the GFF file for exon and intron information, outputs a LD Plot as a PDF     </p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/O_Files/o_snps_chr9_1kgp_high_coverage_recoded.vcf.gz \n-OutPut /Data/home/ajklein/O_Files/O_LDBlock -Region 9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/B_Snps_Positions.txt -MAF 0.0001 -InGFF /Data/home/ajklein/ABOGene.GFF</pre> <p>Andrew looked into the -InGFF argument and changed the ABOGene file to a GFF file and changing the file extention showed the exons in the resulting graph. Andrew also made two folders where he would separate the O and B files.</p> <p>After completing two LD Block graphs for the O and B SNPs he was told to make more of these plots but for the 5 Populations (AMR, AFR, EUR, EAS, and SAS).</p> <p>Before we move on there is another program that comes with LDBlock Show and this program is ShowLDSVF which Andrew will use in the future to tweak the aesthetics of the LD Plots.</p> <p>\u2158/2023 Population Specifc LD Plots</p> <p>In order to make population specific LD Plots here's what Andrew needed to do: * 1 Extract population Sample IDs from a vcf file * 2 Create a txt file for each population that Pink will use to extract individuals * 3 Use Plink to make 10 new vcf files (5 populations, 2 blood types) * 4 Use these new vcf files in LDBlockShow to generate 10 new LD Plots</p> <p>Kiana gave Andrew a large csv file containing the ID data from the individuals from the 1000 genome data. 1000G_2504_high_coverage.sequence.index.csv</p> <p>For some reason in the original 1000 genomes vcf file the way the individuals are identified looks like this: HG03063_HG03063</p> <p>And in order to get plink to extract these individuals from the vcf file the --keep argument in Plink needs to look like this: HG03063_HG03063 HG03063_HG03063 </p> <p>Here is the code that Andrew wrote to categorize the sub populations into the continental populations: (he originally named this csv as \"gamers\")</p> <p>     This creates a new column named \"Continent\" and sorts individuals into their continental population     </p> <pre>list =[\"GIH\", \"PJL\", \"BEB\", \"STU\", \"ITU\", \"SAS\"] \nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] = \"SAS\"\nlist = [\"CEU\",\"TSI\", \"FIN\", \"GBR\", \"IBS\", \"EUR\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"EUR\"\nlist = [\"CHB\", \"JPT\", \"CHS\", \"CDX\",\"KHV\", \"EAS\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"EAS\"\nlist = [\"MXL\", \"PUR\", \"CLM\",\"PEL\", \"AMR\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"AMR\"\nlist = [\"YRI\", 'LWK', \"GWD\", \"MSL\", \"ESN\", \"ASW\", 'ACB', \"AFR\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"AFR\"</pre> <p>     Sorts the csv file via the \"Continent\" column     </p> <pre>csv.arrange= gamers.sort_values(by=\"Continent\", ascending=True)\ncsv.arrange.reset_index(drop=True,inplace=True)\ncsv.arrange</pre> <p> Creates a new column called \"FAMILY_ID\" which is in the format that plink needs. </p> <pre>csv.arrange[\"FAMILY_ID\"] = csv.arrange[\"SAMPLE_NAME\"] + '_'+csv.arrange[\"SAMPLE_NAME\"]\ncsv.arrange</pre> <p>Andrew didn't know how to delete all the columns that he didn't need so he just deleted them from the csv file manually only leaving the columns he needed. (SAMPLE_NAME, Population, Continent, and FAMILY_ID).</p> <p>Now he wrote some code to create a txt file that he can use in plink</p> <p> This will create a new txt file, look through the \"Continent\" column looking for \"AMR\" and when ever there is \"AMR\" write the Family_ID tabspace Family_ID newline into the txt file.</p> <pre>AMR = open(\"amr.txt\", \"w\") \nfor i in range(len(csv)):\n    row= csv.iloc[i]\n    if row[\"Continent\"] == \"AMR\":\n        print(row[\"FAMILY_ID\"])\n        AMR.write(row[\"FAMILY_ID\"] + \"\\t\" +row['FAMILY_ID']+ \"\\n\")\nAMR.close()</pre> <p>Andrew did this for the 5 populations. Resulting in 5 txt files. Now he could use them in Plink.</p> <p> The input is a vcf file and a txt file. This will only keep the individuals that are in the txt file. It will then output a new vcf that only contains the individuals of interest.</p> <pre> plink1.9 --vcf /Data/home/ajklein/B_Files/B_Snps_chr9_1kgp_high_coverage.vcf --keep /Data/home/ajklein/amr.txt --out B_AMR --make-bed --double-id --recode vcf</pre> <p>This is an example of how to make one of the population LD plots reflect the color of the population we're choosing for our paper:</p> <p> This will result in a LD plot that has a color gradient that reflects the color of the population</p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/ShowLDSVG -InPreFix /Data/home/ajklein/O_Files/O_AFR_LDBlock -OutPut /Data/home/ajklein/help.svg -SpeSNPName /Data/home/ajklein/O_Files/O_Snps_Positions.txt -crMiddle 217,160,182 -crEnd 220,57,119 -crTagSNP 0,0,0 -NumGradien 100 -ShowNum</pre> <p>This is how Andrew learned Python, command line, LDBlockShow, and Plink to generate multiple LD Plots!!</p> <p>Known Issues For one of the O Snps in the EAS population (rs8176704), there is no data so the resulting LD Plot does not include this SNP.  LD Calculations were compared to the LD Matrix tool. This also shows the missing data for this SNP within this population. The LD calculations between the website and the program seem to be the same or similar in value.</p>"},{"location":"intro/","title":"Current Projects","text":"<p>Dr. Karnes' Lab</p> <p>Worked on data analysis and generating for an ABO Systematic review. This was my first introduction to R, Python, and Linux programming languages. Currently, I am working on gathering preliminary background research on the disease heparin induced thrombocytopenia (HIT). My dissertation will be on this disease and while I do not have concrete aims at the moment, I have about 10 potential aims. I am working closely with collaborators, other lab members, and my PI to narrow my aims.</p>"},{"location":"personal/","title":"Personal Info","text":"<p>My name is Andrew Klein and I\u2019ve lived in Tucson all my life. I recently graduated from the U of A with a bachelors in physiology and a minor in biochemistry. After doing classical genetic research for 5 years, I\u2019ve found myself in the pharmacy department. I\u2019m currently pursuing a doctoral degree in genetics while working in Dr. Karnes\u2019 lab. After doing classical genetic research for 5 years, I now study pharmacogenetics focusing on the disease heparin-induced thrombocytopenia. This lab has required me to learn how to code and manage sensitive data.</p>"},{"location":"projects/making_LD_plot/","title":"Making a Pairwise LD Plot Using LDBlock Show","text":"<p>Andrew Klein andrewjklein@arizona.edu</p> <p>Our goal is to create a pairwise LD plot of the SNPs used to determine ABO blood type alleles. These SNPs were identified during a systematic review and include both functional SNPs and tag SNPs. </p> <p>The O vs non-O SNPs include: * rs8176719 * rs8176704 * rs687289 * rs657152 * rs612169 * rs8176645 * rs505922 * rs529565</p> <p>The A vs B SNPs include:  * rs8176749 * rs8176747 * rs8176746 * rs8176743 * rs8176741 * rs7853989 * rs8176722 * rs8176720 * rs8176672</p> <p>The documented code will be run on the Karnes Server and we are making the LD plots using the pangenomic 1000g file that can be found here. This file will also contain the notes/thoughts that Andrew was thinking about while making these plots. You will see how he learned how to use PLINK, command line, and LDBlockShow as this file goes on</p>"},{"location":"projects/making_LD_plot/#files-being-used","title":"Files Being Used","text":"<p>All of these files can be found on the Karnes Server under /Data/home/ajklein or /Data/home/ajklein/O_Files or /Data/home/ajklein/B_Files Original Pangenomic 1000Genome file is called 1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz The final VCF files that are being used are: o_snps_chr9_1kgp_high_coverage_recoded.vcf.gz O_AMR.vcf B_AMR.vcf O_AFR.vcf B_AFR.vcf O_EUR.vcf O_EUR.vcf O_EAS.vcf O_EAS.vcf O_SAS.vcf O_SAS.vcf</p> <p>CSV file that contains all the data from the 1000 genomes individuals 1000G_2504_high_coverage.sequence.index.csv </p> <p>Later in this document, I will explain how these files are made</p>"},{"location":"projects/making_LD_plot/#programs-being-used","title":"Programs Being Used","text":"<p>LDBlockShow(https://github.com/BGI-shenzhen/LDBlockShow) is a fast and effective tool to generate linkage disequilibrium (LD) heatmap from VCF files. Here is the LDBlockShow GitHub and the LDBlockShow article. LDBLockShow Manual</p> <p>To call upon this program in the Karnes server use this command: /home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow Now here are some other commands I will be using: * <code>-InVCF</code>: the VCF input * <code>-OutPut</code>: the output file of LD blocks * <code>-Region</code>: the region to show the LD info in * <code>-OutPdf</code>: specifying to output as a PDF * <code>ShowNum</code>: shows the R2 values in each cell * <code>-SeleVar 2</code>: <code>1</code> specifies D prime calculations and <code>2</code> specifies r^2 calculation * <code>-SpeSNPName</code>: used to indicate the names for interested SNPs, these names will be shown in the heatmap. * <code>-MAF</code>: Minor allele frequency filter * <code>-InGFF</code>: the GFF3 input for genomic region annotation</p> <p>ShowLDSVG(https://github.com/BGI-shenzhen/LDBlockShow) This is a program included with LDBlockShow. This program is used to change the aesthetics of the plots that LDBlockShow generates. As of 4/6/2023 Andrew has attemtped to use this program but hasn't figured out everything yet. When he begins to tweak the plots this section may be updated.  To call upon this program in the Karnes server use this command: /home/shared/tools/LDBlockShow-1.40/bin/ShowLDSVG * <code>-InPreFix</code>: The output of LD Block Show (it will grab the correct file type you just need to put in the correct directory) * <code>-OutPut</code>: Used to name the output file and choose where it goes * <code>-OutPdf</code>: specifying to output as a PDF * <code>ShowNum</code>: shows the R2 values in each cell</p> <p>PLINK 1.90 beta (https://www.cog-genomics.org/plink/) Plink is a program that allows users to view, edit, and organize multiple types of files. Developed by Christopher Chang with support from the NIH-NIDDK's Laboratory of Biological Modeling, the Purcell Lab, and others. </p> <p>To call upon this program in the Karnes server use this command: plink1.9 Here are some arguments I will be using:&lt;br\" * <code>--vcf</code>: Inputs the VCF file * <code>--extract</code>: Extracts SNPs based on a txt file that tells PLINK the positions of the SNPs * <code>--recode vcf</code>: changes the output to a vcf file * <code>--out</code>: tells the program where to put the output files * <code>--keep</code>: Accepts a txt file that contains the SAMPLE_ID's if individuals and removes everyone else * <code>--make-bed</code>: I don't know why I need this argument but the program tells you to add it in and it didn't work without it * <code>--double-id</code>: Allows PLINK to ignore any _ in the txt file (Shout out to Christopher Chang for this tip)</p> <p>3/14/2023 Andrew's First Attempt</p> <p>This was the first time Andrew attempted to use LDBlock Show. This is the code he used:</p> <p> Takes a vcf as input, look at a certain region, produces a PNG LD Plot </p> <pre> /home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz\n-OutPut /Data/home/ajklein/LDBlock -Region chr9:133247534-133278152 -OutPng -ShowNum -SeleVar 2 </pre> <p>He didn't know how to output the graph as a PDF yet but this first attempt showed every SNP in the region that he provied in the code. While this was not even close to what he wanted to do he was able to use the program.\\ He did some more research and added some more arguments to his code:</p> <p> Take a vcf and a txt files as input, looks at a certain region, label the snps from the txt document, outputs a LD Plot as a PDF </p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz \n-OutPut /Data/home/ajklein/LDBlock_FULL -Region chr9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/O_Snps_Positions.txt -InGFF /Data/home/ajklein/ABOGene.GFF3</pre> <p>Now he was able to output the graphs as a PDF, label the SNPs he was interested in and tried to use a GFF3 file to show exons and label the gene name. But the -InGFF argument was not working for him at this time.</p> <p>3/15/2023 Andrew Tries Again</p> <p>At this point, Andrew was trying to think of a way to only calculate the SNPs he was interested in. He had ideas about how to do this but he went straight to the source by asking the creator of the program on GitHub. The creator seemed to be active with ~3 day response time. While waiting for a response he continued to learn command line. He learned how to use the \"grep\" and \"zcat\" command to find what SNPs are in a VCF file. He was then introduced to PLINK. He will use PLINK to extract the B and O SNPs that he cares about. </p> <p>First, he used zcat and the grep command to look through the vcf file to figure out how the SNPs he cared about are named. He used genome browser to obtain the position of each SNP and used this position to look for each SNP in the VCF file.</p> <pre>zcat 1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz | grep \"133274084\"</pre> <p>He repeated this command for each SNP and this revealed that his SNPs were documented as \"9:133266790:C:A\". He had to copy these locations into a txt file so he can use PLINK to extract these specific SNPs Now that he had all the positions of the SNPs he had to format the txt file in a specific way. One line of this txt file looked like this:</p> <p>chr9  133256205   133256205   9:133256205:G:C</p> <p>This will tell PLINK what SNPs to extract. He was then able to run this code:</p> <p> Creates a new VCF file that only contains the O SNPs     </p> <pre>plink1.9 --vcf /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz \n--extract O_Snps_Positions.txt --recode vcf --out O_Snps_chr9_1kgp_high_coverage</pre> <p>3/20/2023 The First Roadblock</p> <p>Now that Andrew had the filtered VCF file he tried running LDBlock and at first it looked like it created an LD plot of just the O snps but after a careful look the SNPs were not labeled and there was 7 SNPs not 9. He asked the creator of the program on GitHub why the labels were not showing up. It turns out when the filtered VCF was created chromosome 9 was no longer labeled as chr9, it was now labeled 9. Using nano to adjust the txt file for LDBlock show the labels began to show up. The next issue was getting all of the SNPs to show. The creator introduced Andrew to the -MAF command.</p> <p>     Take a vcf and a txt files as input, looks at a certain region, labels the snps from the txt document, reduces the MAF to 0.0001, outputs a LD Plot as a PDF     </p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/O_Snps_chr9_1kgp_high_coverage.vcf.gz \n-OutPut /Data/home/ajklein/LDBlock_V3 -Region 9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/O_Snps_Positions.txt \n-InGFF /Data/home/ajklein/ABOGene.GFF3</pre> <p>After adding this command Andrew was able to get one of the missing SNPs to show.</p> <p>After looking at the log from LDBlock show Andrew realized the reason the last SNP wasn't showing up. This last SNP was an indel, indels notoriously have issues in these types of programs. He explained the issue to Kiana who was able to brute force recode this indel. (She created a markdown file of how she did this.) Once Kiana was able to do this, Andrew could continue his journey.</p> <p>3/23/2023 The B SNPs</p> <p>In the meantime, he began to do the same thing for the B SNPs.</p> <pre>plink1.9 --vcf /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz --extract B_Snps_Positions_Plink.txt --recode vcf --out B_Snps_chr9_1kgp_high_coverage</pre> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/1kGP_high_coverage_Illumina.chr9.filtered.SNV_INDEL_SV_phased_panel.vcf.gz \n-OutPut /Data/home/ajklein/B_LDBlock_1 -Region chr9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/B_Snps_Positions.txt -InGFF /Data/home/ajklein/ABOGene.GFF3</pre> <p>He did the same thing for B as he did for O. Luckily none of the B SNPs were indels so he did not have any issues with this set of SNPs.</p> <p>4/3/23 Return to the O SNPs</p> <p>While waiting for Kiana to figure out the indel Andrew took a week to work on school and try scientific writing for the first time. As referenced before Kiana was able to fix the indel issue. After Andrew received the new recoded vcf file we was able to fix the graph.</p> <p>     Take a vcf and a txt files as input, looks at a certain region, labels the snps from the txt document, reduces MAF to 0.001, looks at the GFF file for exon and intron information, outputs a LD Plot as a PDF     </p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/LDBlockShow -InVCF /Data/home/ajklein/O_Files/o_snps_chr9_1kgp_high_coverage_recoded.vcf.gz \n-OutPut /Data/home/ajklein/O_Files/O_LDBlock -Region 9:133247534-133278152 -OutPdf -ShowNum -SeleVar 2 -SpeSNPName /Data/home/ajklein/B_Snps_Positions.txt -MAF 0.0001 -InGFF /Data/home/ajklein/ABOGene.GFF</pre> <p>Andrew looked into the -InGFF argument and changed the ABOGene file to a GFF file and changing the file extention showed the exons in the resulting graph. Andrew also made two folders where he would separate the O and B files.</p> <p>After completing two LD Block graphs for the O and B SNPs he was told to make more of these plots but for the 5 Populations (AMR, AFR, EUR, EAS, and SAS).</p> <p>Before we move on there is another program that comes with LDBlock Show and this program is ShowLDSVF which Andrew will use in the future to tweak the aesthetics of the LD Plots.</p> <p>\u2158/2023 Population Specifc LD Plots</p> <p>In order to make population specific LD Plots here's what Andrew needed to do: * 1 Extract population Sample IDs from a vcf file * 2 Create a txt file for each population that Pink will use to extract individuals * 3 Use Plink to make 10 new vcf files (5 populations, 2 blood types) * 4 Use these new vcf files in LDBlockShow to generate 10 new LD Plots</p> <p>Kiana gave Andrew a large csv file containing the ID data from the individuals from the 1000 genome data. 1000G_2504_high_coverage.sequence.index.csv</p> <p>For some reason in the original 1000 genomes vcf file the way the individuals are identified looks like this: HG03063_HG03063</p> <p>And in order to get plink to extract these individuals from the vcf file the --keep argument in Plink needs to look like this: HG03063_HG03063 HG03063_HG03063 </p> <p>Here is the code that Andrew wrote to categorize the sub populations into the continental populations: (he originally named this csv as \"gamers\")</p> <p>     This creates a new column named \"Continent\" and sorts individuals into their continental population     </p> <pre>list =[\"GIH\", \"PJL\", \"BEB\", \"STU\", \"ITU\", \"SAS\"] \nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] = \"SAS\"\nlist = [\"CEU\",\"TSI\", \"FIN\", \"GBR\", \"IBS\", \"EUR\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"EUR\"\nlist = [\"CHB\", \"JPT\", \"CHS\", \"CDX\",\"KHV\", \"EAS\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"EAS\"\nlist = [\"MXL\", \"PUR\", \"CLM\",\"PEL\", \"AMR\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"AMR\"\nlist = [\"YRI\", 'LWK', \"GWD\", \"MSL\", \"ESN\", \"ASW\", 'ACB', \"AFR\"]\nfor i in list:\n    gamers.loc[gamers['POPULATION'] == i, \"Continent\"] =\"AFR\"</pre> <p>     Sorts the csv file via the \"Continent\" column     </p> <pre>csv.arrange= gamers.sort_values(by=\"Continent\", ascending=True)\ncsv.arrange.reset_index(drop=True,inplace=True)\ncsv.arrange</pre> <p> Creates a new column called \"FAMILY_ID\" which is in the format that plink needs. </p> <pre>csv.arrange[\"FAMILY_ID\"] = csv.arrange[\"SAMPLE_NAME\"] + '_'+csv.arrange[\"SAMPLE_NAME\"]\ncsv.arrange</pre> <p>Andrew didn't know how to delete all the columns that he didn't need so he just deleted them from the csv file manually only leaving the columns he needed. (SAMPLE_NAME, Population, Continent, and FAMILY_ID).</p> <p>Now he wrote some code to create a txt file that he can use in plink</p> <p> This will create a new txt file, look through the \"Continent\" column looking for \"AMR\" and when ever there is \"AMR\" write the Family_ID tabspace Family_ID newline into the txt file.</p> <pre>AMR = open(\"amr.txt\", \"w\") \nfor i in range(len(csv)):\n    row= csv.iloc[i]\n    if row[\"Continent\"] == \"AMR\":\n        print(row[\"FAMILY_ID\"])\n        AMR.write(row[\"FAMILY_ID\"] + \"\\t\" +row['FAMILY_ID']+ \"\\n\")\nAMR.close()</pre> <p>Andrew did this for the 5 populations. Resulting in 5 txt files. Now he could use them in Plink.</p> <p> The input is a vcf file and a txt file. This will only keep the individuals that are in the txt file. It will then output a new vcf that only contains the individuals of interest.</p> <pre> plink1.9 --vcf /Data/home/ajklein/B_Files/B_Snps_chr9_1kgp_high_coverage.vcf --keep /Data/home/ajklein/amr.txt --out B_AMR --make-bed --double-id --recode vcf</pre> <p>This is an example of how to make one of the population LD plots reflect the color of the population we're choosing for our paper:</p> <p> This will result in a LD plot that has a color gradient that reflects the color of the population</p> <pre>/home/shared/tools/LDBlockShow-1.40/bin/ShowLDSVG -InPreFix /Data/home/ajklein/O_Files/O_AFR_LDBlock -OutPut /Data/home/ajklein/help.svg -SpeSNPName /Data/home/ajklein/O_Files/O_Snps_Positions.txt -crMiddle 217,160,182 -crEnd 220,57,119 -crTagSNP 0,0,0 -NumGradien 100 -ShowNum</pre> <p>This is how Andrew learned Python, command line, LDBlockShow, and Plink to generate multiple LD Plots!!</p> <p>Known Issues For one of the O Snps in the EAS population (rs8176704), there is no data so the resulting LD Plot does not include this SNP.  LD Calculations were compared to the LD Matrix tool. This also shows the missing data for this SNP within this population. The LD calculations between the website and the program seem to be the same or similar in value.</p>"},{"location":"projects/test/","title":"Test","text":"<p>IF YOU ARE READING THIS IT WORKED</p>"}]}